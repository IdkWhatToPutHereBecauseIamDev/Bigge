(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1053],{9952:(e,t,n)=>{Promise.resolve().then(n.bind(n,28754))},10351:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});let i=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"INFO",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"frontend",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!e||"string"!=typeof e||0===e.trim().length)return console.error("log: title is required and must be a non-empty string"),!1;if(!t||"string"!=typeof t)return console.error("log: text is required and must be a string"),!1;let r=["ERROR","WARN","INFO","DEBUG"].includes(null==n?void 0:n.toUpperCase())?n.toUpperCase():"INFO",a=e.toLowerCase().replace(/\s+/g,"-"),s=("string"==typeof i?i:String(i||"")).toLowerCase().replace(/\s+/g,"-")||"frontend",l={ip:o.ip||void 0,user:o.user||void 0,session:o.session||void 0,server:o.server||void 0,vm:o.vm||void 0},c=[];for(let[e,t]of Object.entries(l))null!=t&&""!==t&&c.push("".concat(e,":").concat(t));let d=c.length>0?c.join(" "):"",u="".concat(a," | ").concat(t," | ").concat(s).concat(d?" | "+d:"");switch(r){case"ERROR":console.error(u);break;case"WARN":console.warn(u);break;case"DEBUG":console.debug(u);break;default:console.log(u)}return!0}},28754:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Y});var i=n(95155),o=n(88661),r=n.n(o),a=n(12115),s=n(20063),l=n(9829),c=n(22663),d=n(47650),u=n(52619),p=n.n(u),g=n(71408),h=n(64531),m=n(99776),f=n(42878),v=n(70898),x=n(57830),b=n(6092),y=n(36032),w=n(22454),S=n(76648),j=n(74667),_=n(10351);function k(){if("undefined"==typeof localStorage)return;let e=localStorage.getItem("vm"),t=e?"callbackUrl_".concat(e):null,n=t?localStorage.getItem(t):null;localStorage.removeItem("vm"),e&&(localStorage.removeItem("logo_".concat(e)),localStorage.removeItem("apiUser_".concat(e))),t&&localStorage.removeItem(t);let i="/create";if(n)try{new URL(n),i=n}catch(e){(0,_.A)("UI","Invalid callbackUrl found in localStorage (".concat(n,"), falling back to ").concat(i),"WARN","redirect-util")}(0,_.A)("UI","Redirecting user to: ".concat(i),"INFO","redirect-util"),window.location.href=i}var R=n(80921),E=n(47992);let I=()=>window.location.hash.startsWith("#display2")?"display2":"primary",N=["is_manual_resolution_mode","manual_width","manual_height"],A=["","1920x1080","1280x720","1366x768","1920x1200","2560x1440","3840x2160","1024x768","800x600","640x480","320x240"],C={"1920x1080":"1920 x 1080 (FHD)","1280x720":"1280 x 720 (HD)","1366x768":"1366 x 768 (Laptop)","1920x1200":"1920 x 1200 (16:10)","2560x1440":"2560 x 1440 (QHD)","3840x2160":"3840 x 2160 (4K UHD)","1024x768":"1024 x 768 (XGA 4:3)","800x600":"800 x 600 (SVGA 4:3)","640x480":"640 x 480 (VGA 4:3)","320x240":"320 x 240 (QVGA 4:3)"},W=[{label:"100%",value:96},{label:"125%",value:120},{label:"150%",value:144},{label:"175%",value:168},{label:"200%",value:192},{label:"225%",value:216},{label:"250%",value:240},{label:"275%",value:264},{label:"300%",value:288}],D=e=>{let t=parseInt(e,10);return isNaN(t)?0:2*Math.floor(t/2)},O=()=>{let e=!0===window.BROWSER_IS_PREMIUM;return{maxWidth:e?3e3:2e3,maxHeight:e?2e3:1e3,isPremium:e}},F=(e,t)=>{let{maxWidth:n,maxHeight:i}=O();return e<=n&&t<=i},M=e=>{let{width:t=120,height:n=30,className:o,...r}=e;return(0,i.jsx)("img",{src:"/img/logo.svg",alt:"browser.lol",width:t,height:n,className:o,style:{objectFit:"contain"},...r})},z=window.location.href.split("#")[0].replace(/[^a-zA-Z0-9.-_]/g,"_"),T=e=>{let t="".concat(z,"_").concat(e);return"display2"===I()&&N.includes(e)?"".concat(t,"_display2"):t},U=function(){var e,t,n,o,r,s,d,u,N,z,U,L,B,P,V,q,H,G,K,J,Y,X;let $,[Q,Z]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(!0),en="display2"===I(),{user:ei}=(0,a.useContext)(y.E),eo=(0,m.jE)(),er=null==ei||null==(e=ei.user)?void 0:e.mail_alias,ea="string"==typeof er&&er.length>0,es=(null==ei||null==(t=ei.user)?void 0:t.unlock_premium)===!0,el="goog.re",[ec,ed]=(0,a.useState)(!1),[eu,ep]=(0,a.useState)(!1),[eg,eh]=(0,a.useState)(""),em=()=>{let e="abcdefghijklmnopqrstuvwxyz0123456789",t="";for(let n=0;n<6;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t};(0,a.useEffect)(()=>{eh(em());let e=setInterval(()=>{eh(em())},200);return()=>clearInterval(e)},[]);let{data:ef,isLoading:ev,isFetching:ex,error:eb,refetch:ey}=(0,w.I)({queryKey:["tempmailMessages"],queryFn:()=>(0,S.A)("/tempmail/list","GET"),refetchInterval:6e4,refetchOnWindowFocus:!0,enabled:es&&ea}),ew=(null==ef?void 0:ef.messages)||[],eS=ew.slice(0,3),ej=ew.length>3;(0,a.useEffect)(()=>((0,R.bz)(e=>{tH(e)}),()=>{(0,R.bz)(null)}),[]),(0,a.useEffect)(()=>{if(!es||!ea)return;let e=localStorage.getItem("token");if(!e)return;let t=null;try{(t=(0,l.io)((0,E.w)(),{path:"/v7/user/socket.io",transports:["websocket"],auth:{token:e}})).on("connect",()=>{(0,_.A)("SIDEBAR","Connected to user socket for email notifications","INFO","sidebar-socket")}),t.on("tempmail_received",e=>{(0,_.A)("SIDEBAR","Received tempmail notification: ".concat(JSON.stringify(e)),"DEBUG","sidebar-socket"),(null==e?void 0:e.status)==="ok"&&(null==e?void 0:e.email)&&(eo.invalidateQueries(["tempmailMessages"]),(0,R.R9)(e.email))}),t.on("disconnect",()=>{(0,_.A)("SIDEBAR","Disconnected from user socket","INFO","sidebar-socket")})}catch(e){(0,_.A)("SIDEBAR","Error connecting to user socket: ".concat(e.message),"ERROR","sidebar-socket")}return()=>{t&&(t.off("connect"),t.off("tempmail_received"),t.off("disconnect"),t.disconnect())}},[es,ea,eo]);let e_=e=>{if(!e)return"N/A";let t=new Date(e),n=Math.abs(new Date-t),i=Math.floor(n/864e5),o=Math.floor(n/36e5),r=Math.floor(n/6e4);return i>1?t.toLocaleDateString():1===i?"Yesterday":o>=1?"".concat(o,"h ago"):r>=1?"".concat(r,"m ago"):"Just now"},ek=async()=>{let e="".concat(eg,"-").concat(er,"@").concat(el);try{await navigator.clipboard.writeText(e),tf(e),window.postMessage({type:"clipboardUpdateFromUI",text:e},window.location.origin),ep(!0),setTimeout(()=>ep(!1),2e3)}catch(e){c.Ay.error("Failed to copy email address")}};(0,a.useEffect)(()=>{window.postMessage({type:"sidebarVisibilityChanged",isOpen:Q},window.location.origin)},[Q]),(0,a.useEffect)(()=>{window.postMessage({type:"setScaleLocally",value:!0},window.location.origin)},[]),(0,a.useEffect)(()=>{let e=localStorage.getItem(T("use_browser_cursors"));window.postMessage({type:"setUseBrowserCursors",value:null===e||"true"===e},window.location.origin)},[]),(0,a.useEffect)(()=>{["encoder","framerate","videoBufferSize","h264_crf","h264_paintover_crf","jpeg_quality","paint_over_jpeg_quality","use_paint_over_quality","h264_fullcolor","h264_streaming_mode","use_cpu","use_css_scaling","antiAliasingEnabled","scaleLocallyManual"].forEach(e=>{localStorage.removeItem(T(e)),localStorage.removeItem("".concat(T(e),"_display2"))})},[]);let[eR,eE]=(0,a.useState)(null),[eI,eN]=(0,a.useState)(!1),[eA,eC]=(0,a.useState)(!1),[eW,eD]=(0,a.useState)(()=>{let e=localStorage.getItem(T("use_browser_cursors"));return null===e||"true"===e}),[eO,eF]=(0,a.useState)(!1),[eM,ez]=(0,a.useState)({Control:!1,Alt:!1,Meta:!1}),[eT,eU]=(0,a.useState)(!0),[eL,eB]=(0,a.useState)(null),[eP,eV]=(0,a.useState)(null),[eq,eH]=(0,a.useState)({}),[eG,eK]=(0,a.useState)("browser.lol"),[eJ,eY]=(0,a.useState)(!0),[eX,e$]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=()=>{e$(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),document.addEventListener("webkitfullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e),document.removeEventListener("webkitfullscreenchange",e)}},[]),(0,a.useEffect)(()=>{let e=e=>{var t;e.origin===window.location.origin&&(null==(t=e.data)?void 0:t.type)==="serverSettings"&&(console.log("Dashboard received server settings:",e.data.payload),eV(e.data.payload))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,a.useEffect)(()=>{var e,t,n,i,o,r,a,s,l,c,d,u,p,g,h,m,f,v,x,b,y,w,S,j,_,k,R,E,I,N,A,C,W,D,O,F,M,z;if(!eP)return;let T={},U=e=>{let t=eP[e];return!t||!0!==t.locked&&(!t.allowed||!(t.allowed.length<=1))&&(void 0===t.min||void 0===t.max||t.min!==t.max)};T.videoSettings=null==(b=null==(e=eP.ui_sidebar_show_video_settings)?void 0:e.value)||b,T.screenSettings=null==(y=null==(t=eP.ui_sidebar_show_screen_settings)?void 0:t.value)||y,T.audioSettings=null==(w=null==(n=eP.ui_sidebar_show_audio_settings)?void 0:n.value)||w,T.stats=null==(S=null==(i=eP.ui_sidebar_show_stats)?void 0:i.value)||S,T.clipboard=null==(j=null==(o=eP.ui_sidebar_show_clipboard)?void 0:o.value)||j,T.files=null==(_=null==(r=eP.ui_sidebar_show_files)?void 0:r.value)||_,T.apps=null==(k=null==(a=eP.ui_sidebar_show_apps)?void 0:a.value)||k,T.sharing=null==(R=null==(s=eP.ui_sidebar_show_sharing)?void 0:s.value)||R,T.fullscreen=null==(E=null==(l=eP.ui_sidebar_show_fullscreen)?void 0:l.value)||E,T.gamingMode=null==(I=null==(c=eP.ui_sidebar_show_gaming_mode)?void 0:c.value)||I,T.trackpad=null==(N=null==(d=eP.ui_sidebar_show_trackpad)?void 0:d.value)||N,T.keyboardButton=null==(A=null==(u=eP.ui_sidebar_show_keyboard_button)?void 0:u.value)||A,T.softButtons=null==(C=null==(p=eP.ui_sidebar_show_soft_buttons)?void 0:p.value)||C,T.coreButtons=null==(W=null==(g=eP.ui_show_core_buttons)?void 0:g.value)||W,T.encoder=U("encoder"),T.framerate=U("framerate"),T.jpeg_quality=U("jpeg_quality"),T.paint_over_jpeg_quality=U("paint_over_jpeg_quality"),T.h264_crf=U("h264_crf"),T.h264PaintoverCRF=U("h264_paintover_crf"),T.usePaintOverQuality=U("use_paint_over_quality"),T.h264StreamingMode=U("h264_streaming_mode"),T.h264FullColor=U("h264_fullcolor"),T.use_cpu=U("use_cpu"),T.uiScaling=U("scaling_dpi"),T.use_browser_cursors=U("use_browser_cursors"),T.hidpi=!0!==(eP.hidpi_enabled||{value:!0,locked:!1}).locked,T.enableSharing=null==(D=null==(h=eP.enable_sharing)?void 0:h.value)||D,T.enableShared=null==(O=null==(m=eP.enable_shared)?void 0:m.value)||O,T.enablePlayer2=null==(F=null==(f=eP.enable_player2)?void 0:f.value)||F,T.enablePlayer3=null==(M=null==(v=eP.enable_player3)?void 0:v.value)||M,T.enablePlayer4=null==(z=null==(x=eP.enable_player4)?void 0:x.value)||z,T.videoToggle=U("video_enabled"),T.audioToggle=U("audio_enabled"),T.microphoneToggle=U("microphone_enabled");let L=eP.file_transfers;T.fileUpload=!L||L.value.includes("upload"),T.fileDownload=!L||L.value.includes("download"),eH(T)},[eP]);let eQ=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="".concat(window.location.href.split("#")[0],"#display2-").concat(e),i="resizable=yes,scrollbars=yes,noopener,noreferrer";t&&(i+=",left=".concat(t.availLeft,",top=").concat(t.availTop,",width=").concat(t.availWidth,",height=").concat(t.availHeight)),window.open(n,"_blank",i),eB(null)},eZ=async()=>{if(!("getScreenDetails"in window)){console.warn("Window Management API not supported. Opening default second screen."),eQ("right");return}try{let e=await window.getScreenDetails(),t=e.currentScreen,n=e.screens.filter(e=>e!==t);if(0===n.length){console.log("No other screens detected. Opening default second screen."),eQ("right");return}let i={};for(let e of n)!i.right&&e.left>=t.left+t.width&&(i.right=e),!i.left&&e.left+e.width<=t.left&&(i.left=e),!i.down&&e.top>=t.top+t.height&&(i.down=e),!i.up&&e.top+e.height<=t.top&&(i.up=e);let o=Object.keys(i);if(1===o.length){let e=o[0],t=i[e];console.log("Auto-placing single screen to the ".concat(e,".")),eQ(e,t)}else o.length>1?(console.log("Multiple placement options found. Showing arrows."),eB(i)):(console.log("No adjacent screens found in cardinal directions. Opening default."),eQ("right"))}catch(e){console.error("Error with Window Management API or permission denied:",e),eQ("right")}};(0,a.useEffect)(()=>{let e=96*(window.devicePixelRatio||1);W&&W.length>0&&eE(W.reduce((t,n)=>Math.abs(n.value-e)<Math.abs(t.value-e)?n:t).value)},[]),(0,a.useEffect)(()=>{let e=navigator.userAgentData&&navigator.userAgentData.mobile||/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);eN(!!e),navigator.userAgentData&&void 0!==navigator.userAgentData.mobile?console.log("Dashboard: Mobile detected via userAgentData.mobile:",navigator.userAgentData.mobile):"string"==typeof navigator.userAgent?console.log("Dashboard: Mobile detected via userAgent string match:",/Mobi|Android/i.test(navigator.userAgent)):console.warn("Dashboard: Mobile detection methods not fully available. Mobile status set to:",!!e)},[]),(0,a.useEffect)(()=>{let e=()=>{console.log("Dashboard: First touch detected. Enabling touch-specific features."),eF(!0)};return window.addEventListener("touchstart",e,{once:!0,passive:!0}),()=>{window.removeEventListener("touchstart",e,{once:!0,passive:!0})}},[]),(0,a.useEffect)(()=>{let e=()=>{let e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))};return window.addEventListener("resize",e),window.addEventListener("orientationchange",e),e(),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[]),(0,a.useEffect)(()=>{let e=()=>{let e=document.querySelector(".video-container");if(e){let t=e.getBoundingClientRect(),n=2*Math.floor(t.width/2),i=2*Math.floor(t.height/2);te(n),tn(i)}else{let e=2*Math.floor(window.innerWidth/2),t=2*Math.floor(window.innerHeight/2);te(e),tn(t)}};window.addEventListener("resize",e),window.addEventListener("orientationchange",e);let t=setTimeout(e,100);return()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e),clearTimeout(t)}},[]),(0,a.useEffect)(()=>{if(!eP)return;let e=eP.scaling_dpi;if(e){let t=parseInt(localStorage.getItem(T("scaling_dpi")),10),n=e.allowed.includes(String(t))?t:parseInt(e.value,10);e5(n),localStorage.setItem(T("scaling_dpi"),n)}let t=eP.ui_title;t&&eK(t.value);let n=eP.ui_show_logo;n&&eY(n.value)},[eP]);let e0=(e,t,n,i)=>{let o=new KeyboardEvent(e,{key:t,code:n,ctrlKey:i.Control,altKey:i.Alt,metaKey:i.Meta,bubbles:!0,cancelable:!0});window.dispatchEvent(o)},e1=(e,t)=>{let n=eM[e],i=Object.values(eM).filter(Boolean).length;n||0!==i?n&&1===i&&window.postMessage({type:"setSynth",value:!1},window.location.origin):window.postMessage({type:"setSynth",value:!0},window.location.origin);let o={...eM,[e]:!n};ez(o),n?(e0("keyup",e,t,o),console.log("Dashboard: Dispatched keyup for ".concat(e," with state:"),o)):(e0("keydown",e,t,o),console.log("Dashboard: Dispatched keydown for ".concat(e," with state:"),o))},e2=(e,t)=>{console.log("Dashboard: Dispatching key press for ".concat(e," with modifiers:"),eM),e0("keydown",e,t,eM),setTimeout(()=>{e0("keyup",e,t,eM)},50)},[e4,e5]=(0,a.useState)(parseInt(localStorage.getItem(T("scaling_dpi")),10)||96),[e3,e6]=(0,a.useState)(localStorage.getItem(T("manual_width"))||""),[e8,e9]=(0,a.useState)(localStorage.getItem(T("manual_height"))||""),[e7,te]=(0,a.useState)(0),[tt,tn]=(0,a.useState)(0),[ti,to]=(0,a.useState)(""),[tr,ta]=(0,a.useState)(!0),[ts,tl]=(0,a.useState)(!0),[tc,td]=(0,a.useState)(!1),[tu,tp]=(0,a.useState)(!1),[tg,th]=(0,a.useState)(!1),[tm,tf]=(0,a.useState)(""),[tv,tx]=(0,a.useState)([]),[tb,ty]=(0,a.useState)([]),[tw,tS]=(0,a.useState)("default"),[tj,t_]=(0,a.useState)("default"),[tk,tR]=(0,a.useState)(!1),[tE,tI]=(0,a.useState)(null),[tN,tA]=(0,a.useState)(!1),[tC,tW]=(0,a.useState)({audioSettings:!1,screenSettings:!1,sharing:!1,tempMail:!1}),[tD,tO]=(0,a.useState)(""),[tF,tM]=(0,a.useState)(!1),[tz,tT]=(0,a.useState)({bottom:20,left:20}),tU=(0,a.useRef)({isDragging:!1,hasDragged:!1,pointerId:null,startX:0,startY:0,initialBottom:0,initialLeft:0}),tL=(0,a.useCallback)((X=e=>{window.postMessage({type:"settings",settings:e},window.location.origin)},function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let i=this;clearTimeout($),$=setTimeout(()=>{X.apply(i,t)},500)}),[]),tB=e=>{e.currentTarget.hasPointerCapture(tU.current.pointerId)&&e.currentTarget.releasePointerCapture(e.pointerId),tU.current.isDragging=!1,tU.current.pointerId=null},tP=(0,a.useCallback)(()=>{console.log("Dashboard: Directly handling virtual keyboard pop.");let e=document.getElementById("keyboard-input-assist"),t=document.getElementById("overlayInput");e?(e.removeAttribute("aria-hidden"),e.value="",e.focus(),console.log("Focused #keyboard-input-assist element to pop keyboard."),t?t.addEventListener("touchstart",()=>{document.activeElement===e&&(e.blur(),console.log("Blurred #keyboard-input-assist on main overlay touch."),e.setAttribute("aria-hidden","true"))},{once:!0,passive:!0}):console.warn("Could not find #overlayInput to attach blur listener.")):console.error("Could not find #keyboard-input-assist element to focus.")},[]),tV=(0,a.useCallback)(async()=>{console.log("Dashboard: Attempting to populate audio devices..."),tA(!0),tI(null),tx([]),ty([]);let e="setSinkId"in HTMLMediaElement.prototype;tR(e),console.log("Dashboard: Output device selection supported:",e);try{console.log("Dashboard: Requesting temporary microphone permission for device listing..."),(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),console.log("Dashboard: Temporary permission granted/available."),console.log("Dashboard: Enumerating media devices...");let t=await navigator.mediaDevices.enumerateDevices();console.log("Dashboard: Devices found:",t);let n=[],i=[];t.forEach((t,o)=>{if(!t.deviceId)return void console.warn("Dashboard: Skipping device with missing deviceId:",t);let r=t.label||("audioinput"===t.kind?"Input Device ".concat(o+1):"Output Device ".concat(o+1));"audioinput"===t.kind?n.push({deviceId:t.deviceId,label:r}):"audiooutput"===t.kind&&e&&i.push({deviceId:t.deviceId,label:r})}),tx(n),ty(i),tS("default"),t_("default"),console.log("Dashboard: Populated ".concat(n.length," inputs, ").concat(i.length," outputs."))}catch(e){console.error("Dashboard: Error getting media devices or permissions:",e),tI("NotAllowedError"===e.name?"Permission denied. Please allow microphone access in browser settings to select devices.":"NotFoundError"===e.name?"No audio devices found.":"Error listing audio devices: ".concat(e.name||"Unknown error"))}finally{tA(!1)}},[]),tq=(0,a.useCallback)(e=>{let t=!tC[e];tW(t=>({...t,[e]:!t[e]})),"audioSettings"===e&&t&&tV()},[tC,tV]);window.location.href.split("#")[0];let tH=async e=>{if(e)try{let t=localStorage.getItem("vm");if(!t)return void c.Ay.error("No active workspace found");let n=await (0,S.A)("/workspace/launch","POST",{workspaceId:t,url:"https://start.browser.lol/mail?id=".concat(e)});"ok"===n.status?c.Ay.success("Opening email"):c.Ay.error(n.message||"Failed to open email")}catch(e){console.error("Error opening email:",e),c.Ay.error("Failed to open email")}},tG=async()=>{if(!tD.trim())return void c.Ay.error("Please enter a URL");let e=(e=>{if(!e||!e.trim())return e;let t=e.trim();if(t.startsWith("http://")||t.startsWith("https://"))try{return new URL(t),t}catch(e){return"https://www.google.com/search?q=".concat(encodeURIComponent(t))}return/^[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,}(:[0-9]+)?(\/.*)?$/i.test(t)||/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(:[0-9]+)?(\/.*)?$/.test(t)||/^localhost(:[0-9]+)?(\/.*)?$/i.test(t)?"https://".concat(t):"https://www.google.com/search?q=".concat(encodeURIComponent(t))})(tD);tM(!0);try{let t=localStorage.getItem("vm");if(!t)return void c.Ay.error("No active workspace found");let n=await (0,S.A)("/workspace/launch","POST",{workspaceId:t,url:e});"ok"===n.status?(c.Ay.success("Browser window launched"),tO("")):c.Ay.error(n.message||"Failed to launch URL")}catch(e){console.error("Error launching URL:",e),c.Ay.error("Failed to launch URL")}finally{tM(!1)}},tK=(0,a.useCallback)(()=>{let e=!eA;eC(e);let t=e?"touchinput:trackpad":"touchinput:touch";console.log("Dashboard: Toggling trackpad mode. Sending: ".concat(t)),window.postMessage({type:t},window.location.origin)},[eA]),tJ=(0,a.useCallback)(()=>{let e=!eW;eD(e),localStorage.setItem(T("use_browser_cursors"),e.toString()),window.postMessage({type:"setUseBrowserCursors",value:e},window.location.origin),console.log("Dashboard: Browser cursors ".concat(e?"enabled":"disabled"))},[eW]);(0,a.useEffect)(()=>{let e=e=>{if(e.origin!==window.location.origin)return;let t=e.data;if("object"==typeof t&&null!==t)if("pipelineStatusUpdate"===t.type)void 0!==t.video&&ta(t.video),void 0!==t.audio&&(tl(t.audio),tp(!1)),void 0!==t.microphone&&(td(t.microphone),th(!1));else if("clientRoleUpdate"===t.type&&"viewer"===t.role)et(!1);else if("sidebarButtonStatusUpdate"===t.type)void 0!==t.video&&ta(t.video),void 0!==t.audio&&(tl(t.audio),tp(!1)),void 0!==t.microphone&&(td(t.microphone),th(!1));else if("clipboardContentUpdate"===t.type)"string"==typeof t.text&&tf(t.text);else if("audioDeviceStatusUpdate"===t.type)void 0!==t.inputDeviceId&&tS(t.inputDeviceId||"default"),void 0!==t.outputDeviceId&&t_(t.outputDeviceId||"default");else if("microphoneError"===t.type){th(!1);let{name:e,message:n}=t.error||{},i="Microphone error: ".concat(e||"Unknown"," - ").concat(n||"Unknown error");"NotFoundError"===e?i="No microphone found. Please connect a microphone and try again.":"NotAllowedError"===e&&(i="Microphone access denied. Please allow microphone permission in your browser settings."),c.Ay.error(i,{duration:5e3})}else"trackpadModeUpdate"===t.type&&"boolean"==typeof t.enabled&&eC(t.enabled)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[Q]);let tY=(()=>{let{maxWidth:e,maxHeight:t}=O();return[{value:A[0],isDisabled:!1},...A.slice(1).sort((e,t)=>{let[n,i]=e.split("x").map(Number),[o,r]=t.split("x").map(Number);return o*r-n*i}).map(n=>{let i=n.split("x"),o=parseInt(i[0],10),r=parseInt(i[1],10);return{value:n,isDisabled:o>e||r>t}})]})(),{isPremium:tX}=O(),t$=tY.map((e,t)=>({value:e.value,text:0===t?"-- Select Preset --":(C[e.value]||e.value)+(e.isDisabled?" (Premium)":""),isDisabled:e.isDisabled}));if(eP&&(null==(n=eP.ui_show_sidebar)?void 0:n.value)===!1)return null;let tQ="sidebar ".concat(Q?"is-open":"");return[{id:"shared",label:"Read only viewer",tooltip:"Read only client for viewing, as many clients as needed can connect to this endpoint and see the live session",hash:"#shared"},{id:"player2",label:"Controller 2",tooltip:"Player 2 input endpoint",hash:"#player2"},{id:"player3",label:"Controller 3",tooltip:"Player 3 input endpoint",hash:"#player3"},{id:"player4",label:"Controller 4",tooltip:"Player 4 input endpoint",hash:"#player4"}].filter(e=>{var t,n,i,o;return"shared"===e.id?null==(t=eq.enableShared)||t:"player2"===e.id?null==(n=eq.enablePlayer2)||n:"player3"===e.id?null==(i=eq.enablePlayer3)||i:"player4"===e.id&&(null==(o=eq.enablePlayer4)||o)}),(0,i.jsxs)(i.Fragment,{children:[ee&&(0,i.jsx)("div",{className:"toggle-handle ".concat(Q?"sidebar-open":""),onClick:()=>{Z(!Q)},title:"".concat(Q?"Close":"Open"," Dashboard"),children:(0,i.jsx)("div",{className:"toggle-indicator"})}),eL&&(()=>{let e={position:"absolute",width:"100px",height:"100px",backgroundColor:"rgba(97, 218, 251, 0.8)",color:"var(--sidebar-bg, #20232a)",border:"2px solid var(--sidebar-bg, #20232a)",borderRadius:"15px",fontSize:"48px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",pointerEvents:"all",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.3)",transition:"transform 0.2s ease"},t=(e,t,n)=>{e.stopPropagation(),eQ(t,n)};return(0,i.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:9999,pointerEvents:"auto"},onClick:()=>eB(null),children:[eL.up&&(0,i.jsx)("button",{style:{...e,top:"40px",left:"50%",transform:"translateX(-50%)"},onClick:e=>t(e,"up",eL.up),children:"▲"}),eL.down&&(0,i.jsx)("button",{style:{...e,bottom:"40px",left:"50%",transform:"translateX(-50%)"},onClick:e=>t(e,"down",eL.down),children:"▼"}),eL.left&&(0,i.jsx)("button",{style:{...e,left:"40px",top:"50%",transform:"translateY(-50%)"},onClick:e=>t(e,"left",eL.left),children:"◄"}),eL.right&&(0,i.jsx)("button",{style:{...e,right:"40px",top:"50%",transform:"translateY(-50%)"},onClick:e=>t(e,"right",eL.right),children:"►"})]})})(),(0,i.jsxs)("div",{className:tQ,children:[(0,i.jsxs)("div",{className:"sidebar-header",children:[eJ&&(0,i.jsx)(p(),{href:"/",children:(0,i.jsx)(M,{width:120,height:30})}),(0,i.jsxs)("div",{className:"header-controls",children:[(null==(z=eq.fullscreen)||z)&&(0,i.jsx)("button",{className:"header-action-button fullscreen-button ".concat(eX?"active":""),onClick:()=>{if(document.fullscreenElement)document.exitFullscreen?document.exitFullscreen().catch(e=>console.error("Error exiting fullscreen:",e)):document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{let e=document.documentElement;e.requestFullscreen?e.requestFullscreen().catch(e=>{console.error("Error attempting to enable full-screen mode: ".concat(e.message," (").concat(e.name,")"))}):e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}},title:eX?"Exit Fullscreen":"Enter Fullscreen",children:(0,i.jsx)(f.bPR,{})}),(eI||eO)&&(null==(U=eq.trackpad)||U)&&(0,i.jsx)("button",{className:"header-action-button trackpad-mode-button ".concat(eA?"active":""),onClick:tK,title:"Trackpad Mode",children:(0,i.jsx)(f.fV0,{})}),(0,i.jsx)("button",{className:"header-action-button exit-button",onClick:k,title:"Exit Session",children:(0,i.jsx)(f.xsM,{})})]})]}),!en&&(null==(L=eq.coreButtons)||L)&&(0,i.jsxs)("div",{className:"sidebar-action-buttons-simple",children:[(null==(B=eq.audioToggle)||B)&&(0,i.jsx)("button",{className:"action-button ".concat(ts?"active":""," ").concat(tu?"loading":""),onClick:()=>{tp(!0),window.postMessage({type:"pipelineControl",pipeline:"audio",enabled:!ts},window.location.origin)},disabled:tu,title:tu?"Loading...":ts?"Disable Audio Stream":"Enable Audio Stream",children:tu?(0,i.jsx)(j.kiM,{className:"spinner"}):(0,i.jsx)(f.ncz,{})}),(null==(P=eq.microphoneToggle)||P)&&(0,i.jsx)("button",{className:"action-button ".concat(tc?"active":""," ").concat(tg?"loading":""),onClick:()=>{th(!0),window.postMessage({type:"pipelineControl",pipeline:"microphone",enabled:!tc},window.location.origin)},disabled:tg,title:tg?"Loading...":tc?"Disable Microphone":"Enable Microphone",children:tg?(0,i.jsx)(j.kiM,{className:"spinner"}):(0,i.jsx)(f.eFK,{})})]}),!en&&(0,i.jsx)("div",{className:"sidebar-inline-section",children:(0,i.jsxs)("div",{className:"navigate-input-group",children:[(0,i.jsx)("input",{type:"text",className:"allow-native-input navigate-input",placeholder:"Enter URL...",value:tD,onChange:e=>tO(e.target.value),onKeyDown:e=>"Enter"===e.key&&!tF&&tG()}),(0,i.jsx)("button",{onClick:tG,disabled:tF,className:"navigate-button",children:tF?(0,i.jsx)(j.kiM,{className:"spinner"}):"Go"})]})}),!en&&(null==(V=eq.clipboard)||V)&&(0,i.jsx)("div",{className:"sidebar-inline-section",children:(0,i.jsx)("textarea",{className:"allow-native-input sidebar-clipboard-textarea",id:"dashboardClipboardTextarea",value:tm,onChange:e=>tf(e.target.value),onBlur:e=>window.postMessage({type:"clipboardUpdateFromUI",text:e.target.value},window.location.origin),rows:"3",placeholder:"Clipboard..."})}),(eI||eO)&&(null==(q=eq.softButtons)||q)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"sidebar-section-divider"}),(0,i.jsxs)("div",{className:"sidebar-mobile-key-actions",children:[(0,i.jsx)("button",{className:"mobile-key-button ".concat(eM.Control?"active":""),onClick:()=>e1("Control","ControlLeft"),onMouseDown:e=>e.preventDefault(),children:"CTL"}),(0,i.jsx)("button",{className:"mobile-key-button ".concat(eM.Alt?"active":""),onClick:()=>e1("Alt","AltLeft"),onMouseDown:e=>e.preventDefault(),children:"ALT"}),(0,i.jsx)("button",{className:"mobile-key-button ".concat(eM.Meta?"active":""),onClick:()=>e1("Meta","MetaLeft"),onMouseDown:e=>e.preventDefault(),children:"WIN"}),(0,i.jsx)("button",{className:"mobile-key-button",onClick:()=>e2("Tab","Tab"),onMouseDown:e=>e.preventDefault(),children:"TAB"}),(0,i.jsx)("button",{className:"mobile-key-button",onClick:()=>e2("Escape","Escape"),onMouseDown:e=>e.preventDefault(),children:"ESC"}),(0,i.jsx)("button",{className:"mobile-key-button icon-button ".concat(eT?"active":""),onClick:()=>{eU(e=>!e)},children:(0,i.jsx)(f.vFs,{})})]})]}),(null==(H=eq.screenSettings)||H)&&(0,i.jsxs)("div",{className:"sidebar-section",children:[(0,i.jsxs)("div",{className:"sidebar-section-header",onClick:()=>tq("screenSettings"),role:"button","aria-expanded":tC.screenSettings,"aria-controls":"screen-settings-content",tabIndex:"0",onKeyDown:e=>("Enter"===e.key||" "===e.key)&&tq("screenSettings"),children:[(0,i.jsx)("h3",{children:"Screen Settings"}),(0,i.jsx)("span",{className:"section-toggle-icon",children:tC.screenSettings?(0,i.jsx)(f.XNc,{}):(0,i.jsx)(f._kA,{})})]}),tC.screenSettings&&(0,i.jsxs)("div",{className:"sidebar-section-content",id:"screen-settings-content",children:[!en&&(0,i.jsxs)(i.Fragment,{children:[(null==eP||null==(o=eP.second_screen)?void 0:o.value)&&(0,i.jsx)("button",{className:"resolution-button toggle-button",onClick:eZ,style:{marginBottom:"10px"},title:"Add a second screen",children:"Add Screen +"}),(null==(G=eq.uiScaling)||G)&&(0,i.jsxs)("div",{className:"dev-setting-item",children:[(0,i.jsx)("label",{htmlFor:"uiScalingSelect",children:"UI Scaling"}),(0,i.jsx)("select",{id:"uiScalingSelect",value:e4,onChange:e=>{let t=parseInt(e.target.value,10);e5(t),tL({scaling_dpi:t})},disabled:(null==eP||null==(s=eP.scaling_dpi)||null==(r=s.allowed)?void 0:r.length)<=1,children:((null==eP||null==(u=eP.scaling_dpi)||null==(d=u.allowed)?void 0:d.length)>0?eP.scaling_dpi.allowed.map(e=>({label:"".concat(Math.round(parseInt(e,10)/96*100),"%"),value:parseInt(e,10)})):W).map(e=>(0,i.jsx)("option",{value:e.value,children:e.value===eR?"".concat(e.label," *"):e.label},e.value))})]})]}),!(null==eP||null==(N=eP.is_manual_resolution_mode)?void 0:N.locked)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"dev-setting-item",children:[(0,i.jsx)("label",{htmlFor:"resolutionPresetSelect",children:"Preset:"}),(0,i.jsx)("select",{id:"resolutionPresetSelect",value:ti,onChange:e=>{let t=e.target.value;if(to(t),!t)return;let n=t.split("x");if(2===n.length){let e=parseInt(n[0],10),i=parseInt(n[1],10);if(!isNaN(e)&&e>0&&!isNaN(i)&&i>0){let t=D(e),n=D(i);if(!F(t,n)){let{maxWidth:e,maxHeight:t}=O();c.Ay.error("Resolution exceeds maximum allowed (".concat(e,"x").concat(t,")."),{duration:4e3,style:{background:"#333",color:"#fff"}}),to("");return}e6(t.toString()),e9(n.toString()),window.postMessage({type:"setManualResolution",width:t,height:n},window.location.origin)}else console.error("Dashboard: Error parsing selected resolution preset:",t)}},children:t$.map((e,t)=>(0,i.jsx)("option",{value:e.value,disabled:0===t||e.isDisabled,children:e.text},t))})]}),!tX&&(0,i.jsx)("p",{className:"resolution-upgrade-note",children:"Upgrade to Premium for higher resolutions."}),(0,i.jsxs)("div",{className:"resolution-manual-inputs",children:[(0,i.jsxs)("div",{className:"dev-setting-item manual-input-item",children:[(0,i.jsx)("label",{htmlFor:"manualWidthInput",children:"Width:"}),(0,i.jsx)("input",{className:"allow-native-input",type:"number",id:"manualWidthInput",min:"1",max:O().maxWidth,step:"2",placeholder:e7>0?e7.toString():"e.g., 1920",value:e3,onChange:e=>{e6(e.target.value),to("")}})]}),(0,i.jsxs)("div",{className:"dev-setting-item manual-input-item",children:[(0,i.jsx)("label",{htmlFor:"manualHeightInput",children:"Height:"}),(0,i.jsx)("input",{className:"allow-native-input",type:"number",id:"manualHeightInput",min:"1",max:O().maxHeight,step:"2",placeholder:tt>0?tt.toString():"e.g., 1080",value:e8,onChange:e=>{e9(e.target.value),to("")}})]})]}),(0,i.jsxs)("div",{className:"resolution-action-buttons",children:[(0,i.jsx)("button",{className:"resolution-button",onClick:()=>{let e=parseInt(e3.trim(),10),t=parseInt(e8.trim(),10);if(isNaN(e)||e<=0||isNaN(t)||t<=0)return void c.Ay.error("Please enter valid positive integers for Width and Height.",{duration:4e3,style:{background:"#333",color:"#fff"}});let n=D(e),i=D(t);if(!F(n,i)){let{maxWidth:e,maxHeight:t}=O();c.Ay.error("Resolution exceeds maximum allowed (".concat(e,"x").concat(t,"). Please enter a smaller resolution."),{duration:4e3,style:{background:"#333",color:"#fff"}});return}e6(n.toString()),e9(i.toString()),to(""),window.postMessage({type:"setManualResolution",width:n,height:i},window.location.origin)},children:"Set Manual Resolution"}),(0,i.jsx)("button",{className:"resolution-button reset-button",onClick:()=>{e6(""),e9(""),to(""),window.postMessage({type:"resetResolutionToWindow"},window.location.origin)},children:"Reset to Window"})]})]}),(null==(K=eq.use_browser_cursors)||K)&&(0,i.jsxs)("div",{className:"dev-setting-item toggle-item",children:[(0,i.jsx)("label",{htmlFor:"browserCursorsToggle",children:"Use Local Cursor"}),(0,i.jsx)("button",{id:"browserCursorsToggle",className:"toggle-button-sidebar ".concat(eW?"active":""),onClick:tJ,title:eW?"Using local cursor (no cursor on mobile)":"Using remote cursor overlay (visible on mobile)",children:(0,i.jsx)("span",{className:"toggle-button-sidebar-knob"})})]})]})]}),!en&&(0,i.jsxs)(i.Fragment,{children:[(null==(J=eq.audioSettings)||J)&&(0,i.jsxs)("div",{className:"sidebar-section",children:[(0,i.jsxs)("div",{className:"sidebar-section-header",onClick:()=>tq("audioSettings"),role:"button","aria-expanded":tC.audioSettings,"aria-controls":"audio-settings-content",tabIndex:"0",onKeyDown:e=>("Enter"===e.key||" "===e.key)&&tq("audioSettings"),children:[(0,i.jsx)("h3",{children:"Audio Settings"}),(0,i.jsx)("span",{className:"section-toggle-icon",children:tN?(0,i.jsx)(j.kiM,{className:"spinner"}):tC.audioSettings?(0,i.jsx)(f.XNc,{}):(0,i.jsx)(f._kA,{})})]}),tC.audioSettings&&(0,i.jsxs)("div",{className:"sidebar-section-content",id:"audio-settings-content",children:[tE&&(0,i.jsx)("div",{className:"error-message",children:tE}),(0,i.jsxs)("div",{className:"dev-setting-item",children:[(0,i.jsx)("label",{htmlFor:"audioInputSelect",children:"Input (Microphone):"}),(0,i.jsx)("select",{id:"audioInputSelect",value:tw,onChange:e=>{let t=e.target.value;tS(t),window.postMessage({type:"audioDeviceSelected",context:"input",deviceId:t},window.location.origin)},disabled:tN||!!tE,className:"audio-device-select",children:tv.map(e=>(0,i.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId))})]}),tk&&(0,i.jsxs)("div",{className:"dev-setting-item",children:[(0,i.jsx)("label",{htmlFor:"audioOutputSelect",children:"Output (Speaker):"}),(0,i.jsx)("select",{id:"audioOutputSelect",value:tj,onChange:e=>{let t=e.target.value;t_(t),window.postMessage({type:"audioDeviceSelected",context:"output",deviceId:t},window.location.origin)},disabled:tN||!!tE,className:"audio-device-select",children:tb.map(e=>(0,i.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId))})]}),!tk&&!tN&&!tE&&(0,i.jsx)("p",{className:"device-support-notice",children:"Output device selection not supported by this browser."})]})]}),(0,i.jsxs)("div",{className:"sidebar-section",children:[(0,i.jsxs)("div",{className:"sidebar-section-header",onClick:()=>tq("tempMail"),role:"button","aria-expanded":tC.tempMail,"aria-controls":"tempmail-content",tabIndex:"0",onKeyDown:e=>("Enter"===e.key||" "===e.key)&&tq("tempMail"),children:[(0,i.jsx)("h3",{children:"Temp Mail"}),(0,i.jsx)("span",{className:"section-toggle-icon",children:tC.tempMail?(0,i.jsx)(f.XNc,{}):(0,i.jsx)(f._kA,{})})]}),tC.tempMail&&(0,i.jsxs)("div",{className:"sidebar-section-content",id:"tempmail-content",style:{padding:"12px 0"},children:[!es&&(0,i.jsxs)("div",{style:{background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",border:"1px solid #bfdbfe",borderRadius:"12px",padding:"20px",textAlign:"center"},children:[(0,i.jsx)("div",{style:{width:"48px",height:"48px",margin:"0 auto 12px",background:"linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%)",borderRadius:"12px",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"20px"},children:(0,i.jsx)(f.SOx,{})}),(0,i.jsx)("h4",{style:{fontSize:"15px",fontWeight:"600",color:"#1e40af",margin:"0 0 8px"},children:"Anonymous Email"}),(0,i.jsx)("p",{style:{fontSize:"12px",color:"#3b82f6",margin:"0 0 16px",lineHeight:"1.5"},children:"Get a private email address for sign-ups and verifications."}),(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px",marginBottom:"16px"},children:[{icon:(0,i.jsx)(v.SMR,{}),text:"Privacy Protection"},{icon:(0,i.jsx)(v.dhv,{}),text:"Custom Aliases"},{icon:(0,i.jsx)(b.vky,{}),text:"AI Email Analysis"}].map((e,t)=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",fontSize:"11px",color:"#1e40af"},children:[(0,i.jsx)("span",{style:{color:"#3b82f6",fontSize:"10px"},children:e.icon}),(0,i.jsx)("span",{children:e.text})]},t))}),(0,i.jsxs)(p(),{href:"/upgrade",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"10px 20px",background:"linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%)",color:"white",borderRadius:"8px",fontSize:"13px",fontWeight:"600",textDecoration:"none",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(37, 99, 235, 0.3)"},children:[(0,i.jsx)(v.Hu1,{style:{marginRight:"8px",fontSize:"12px"}}),"Upgrade to Premium"]})]}),es&&(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px",padding:"0 12px"},children:[(0,i.jsx)("hr",{style:{border:"none",borderTop:"1px solid #e2e8f0",margin:"0"}}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:ea?"8px":"0"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,i.jsx)("div",{style:{width:"28px",height:"28px",borderRadius:"6px",background:"linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"12px"},children:(0,i.jsx)(x.kap,{})}),(0,i.jsx)("span",{style:{fontSize:"12px",fontWeight:"500",color:"#64748b"},children:"Your Alias"})]}),(0,i.jsxs)(p(),{href:"/dash/mail",target:"_blank",rel:"noopener noreferrer",style:{fontSize:"11px",color:"#0ea5e9",textDecoration:"none",display:"flex",alignItems:"center",gap:"4px"},children:[(0,i.jsx)(x.hgV,{style:{fontSize:"12px"}}),"Manage"]})]}),ea?(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"6px",padding:"8px 10px"},children:[(0,i.jsxs)("code",{style:{flex:1,fontSize:"12px",fontFamily:"ui-monospace, monospace",color:"#334155",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[(0,i.jsxs)("span",{style:{color:"#94a3b8"},children:[eg,"-"]}),er,"@",el]}),(0,i.jsx)("button",{onClick:ek,style:{padding:"4px 8px",background:eu?"#10b981":"#f1f5f9",border:"1px solid",borderColor:eu?"#10b981":"#e2e8f0",borderRadius:"4px",color:eu?"white":"#64748b",fontSize:"10px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",transition:"all 0.2s ease"},children:eu?(0,i.jsx)(v.CMH,{}):(0,i.jsx)(v.paH,{})})]}):(0,i.jsxs)("div",{style:{background:"#fef3c7",border:"1px solid #fcd34d",borderRadius:"6px",padding:"10px",display:"flex",alignItems:"flex-start",gap:"8px"},children:[(0,i.jsx)(v.BS8,{style:{color:"#d97706",fontSize:"12px",marginTop:"2px",flexShrink:0}}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{style:{fontSize:"11px",fontWeight:"600",color:"#92400e",margin:"0 0 4px"},children:"No alias configured"}),(0,i.jsx)(p(),{href:"/dash/mail",style:{fontSize:"11px",color:"#d97706",textDecoration:"underline"},children:"Set up your email alias"})]})]})]}),ea&&(0,i.jsxs)("div",{children:[(0,i.jsx)("hr",{style:{border:"none",borderTop:"1px solid #e2e8f0",margin:"0 0 12px 0"}}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px",padding:"0 2px"},children:[(0,i.jsxs)("span",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",fontWeight:"600",color:"#334155"},children:[(0,i.jsx)(f.Jex,{style:{fontSize:"14px"}}),"Inbox",ew.length>0&&(0,i.jsx)("span",{style:{background:"#0ea5e9",color:"white",fontSize:"10px",fontWeight:"600",padding:"2px 6px",borderRadius:"10px"},children:ew.length})]}),(0,i.jsx)("button",{onClick:()=>{ey()},disabled:ev||ex,style:{width:"26px",height:"26px",display:"flex",alignItems:"center",justifyContent:"center",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"6px",color:ev||ex?"#94a3b8":"#64748b",cursor:ev||ex?"not-allowed":"pointer",fontSize:"12px",transition:"all 0.2s ease"},title:"Refresh inbox",children:(0,i.jsx)(f.mzO,{style:{animation:ev||ex?"spin 1s linear infinite":"none"}})})]}),eb&&(0,i.jsx)("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"12px",textAlign:"center",color:"#dc2626",fontSize:"11px"},children:"Failed to load emails. Try refreshing."}),ev&&!eb&&(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",padding:"20px",color:"#64748b",fontSize:"12px"},children:[(0,i.jsx)(v.hW,{className:"spinner",style:{fontSize:"12px"}}),"Loading..."]}),!ev&&!eb&&0===ew.length&&(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"6px",padding:"20px",color:"#94a3b8",fontSize:"12px"},children:[(0,i.jsx)(f.Jex,{style:{fontSize:"24px"}}),(0,i.jsx)("span",{children:"No emails yet"})]}),!ev&&!eb&&eS.length>0&&(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:eS.map(e=>(0,i.jsxs)("div",{onClick:()=>tH(e.id),style:{background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"10px",cursor:"pointer",transition:"all 0.15s ease"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#0ea5e9",e.currentTarget.style.background="#f0f9ff"},onMouseLeave:e=>{e.currentTarget.style.borderColor="#e2e8f0",e.currentTarget.style.background="#f8fafc"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"4px"},children:[(0,i.jsx)("span",{style:{fontSize:"10px",color:"#64748b",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"140px"},children:e.sender}),(0,i.jsx)("span",{style:{fontSize:"9px",color:"#94a3b8"},children:e_(e.received)})]}),(0,i.jsx)("div",{style:{fontSize:"12px",fontWeight:"500",color:"#334155",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title||"(No Subject)"}),e.ai_summary&&(0,i.jsx)("div",{style:{fontSize:"10px",color:"#64748b",marginTop:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.ai_summary})]},e.id))}),ej&&(0,i.jsxs)("button",{onClick:()=>ed(!0),style:{width:"100%",marginTop:"8px",padding:"10px",background:"linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"12px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},children:["View all ",ew.length," emails"]})]})]})]})]})]})]}),(0,i.jsx)(g.N,{children:ec&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},onClick:()=>ed(!1),style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.4)",backdropFilter:"blur(4px)",zIndex:1999}}),(0,i.jsxs)(h.P.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:300},style:{position:"fixed",top:0,right:0,width:"360px",maxWidth:"90vw",height:"100vh",background:"white",boxShadow:"-4px 0 24px rgba(0, 0, 0, 0.15)",zIndex:2e3,display:"flex",flexDirection:"column"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",borderBottom:"1px solid #e2e8f0",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,i.jsx)("div",{style:{width:"36px",height:"36px",borderRadius:"10px",background:"linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"16px"},children:(0,i.jsx)(f.Jex,{})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{style:{margin:0,fontSize:"16px",fontWeight:"600",color:"#1e293b"},children:"Inbox"}),(0,i.jsxs)("p",{style:{margin:0,fontSize:"12px",color:"#64748b"},children:[ew.length," email",1!==ew.length?"s":""]})]})]}),(0,i.jsx)("button",{onClick:()=>ed(!1),style:{width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"8px",color:"#64748b",cursor:"pointer",transition:"all 0.15s ease",fontSize:"20px"},onMouseEnter:e=>{e.currentTarget.style.background="#f1f5f9",e.currentTarget.style.color="#334155"},onMouseLeave:e=>{e.currentTarget.style.background="transparent",e.currentTarget.style.color="#64748b"},children:(0,i.jsx)(f.lr4,{})})]}),(0,i.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"12px"},children:0===ew.length?(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"200px",color:"#94a3b8"},children:[(0,i.jsx)(f.Jex,{style:{fontSize:"48px",marginBottom:"12px"}}),(0,i.jsx)("span",{style:{fontSize:"14px"},children:"No emails yet"})]}):(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:ew.map(e=>(0,i.jsxs)(h.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},onClick:()=>{setSelectedEmail(e),ed(!1)},style:{background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"10px",padding:"14px",cursor:"pointer",transition:"all 0.15s ease"},whileHover:{borderColor:"#0ea5e9",background:"#f0f9ff"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,i.jsx)(v.XiY,{style:{fontSize:"10px",color:"#94a3b8"}}),(0,i.jsx)("span",{style:{fontSize:"11px",color:"#64748b",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"180px"},children:e.sender})]}),(0,i.jsx)("span",{style:{fontSize:"10px",color:"#94a3b8"},children:e_(e.received)})]}),(0,i.jsx)("div",{style:{fontSize:"13px",fontWeight:"600",color:"#334155",marginBottom:"6px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title||"(No Subject)"}),e.ai_summary&&(0,i.jsx)("div",{style:{fontSize:"11px",color:"#64748b",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:e.ai_summary}),e.ai_calltoaction_value&&(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginTop:"8px",padding:"6px 8px",background:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",borderRadius:"6px",border:"1px solid #bfdbfe"},children:[(0,i.jsx)(b.vky,{style:{fontSize:"10px",color:"#3b82f6"}}),(0,i.jsx)("code",{style:{fontSize:"10px",color:"#1e40af",fontFamily:"ui-monospace, monospace",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.ai_calltoaction_value})]})]},e.id))})})]})]})}),(eI||eO)&&eT&&(null==(Y=eq.keyboardButton)||Y)&&(0,i.jsx)("button",{className:"virtual-keyboard-button allow-native-input",onClick:e=>{if(tU.current.hasDragged){e.preventDefault(),e.stopPropagation(),tU.current.hasDragged=!1;return}tP()},onPointerDown:e=>{tU.current.isDragging=!0,tU.current.hasDragged=!1,tU.current.pointerId=e.pointerId,tU.current.startX=e.clientX,tU.current.startY=e.clientY,tU.current.initialBottom=tz.bottom,tU.current.initialLeft=tz.left,e.currentTarget.setPointerCapture(e.pointerId)},onPointerMove:e=>{if(!tU.current.isDragging)return;let t=e.clientX-tU.current.startX,n=e.clientY-tU.current.startY;!tU.current.hasDragged&&(Math.abs(t)>10||Math.abs(n)>10)&&(tU.current.hasDragged=!0),tU.current.hasDragged&&tT({bottom:tU.current.initialBottom-n,left:tU.current.initialLeft+t})},onPointerUp:tB,onPointerCancel:tB,style:{position:"fixed",left:"".concat(tz.left,"px"),bottom:"".concat(tz.bottom,"px"),touchAction:"none"},title:"Pop Keyboard","aria-label":"Pop Keyboard",children:(0,i.jsx)(f.vFs,{})})]})};n(50497);let L=function(e){let{container:t}=e;return t?d.createPortal((0,i.jsx)("div",{className:"dashboard-overlay-container",children:(0,i.jsx)(U,{})}),t):null};var B=n(47063);function P(e){let{status:t,viewerStatus:n,workspace:o,logoUrl:r}=e,[s,l]=(0,a.useState)(0),[c,d]=(0,a.useState)(0),[u,p]=(0,a.useState)(!1),g=(0,a.useRef)(!1),h=[{message:"Connecting to streaming server",icon:(0,i.jsx)(v.vwk,{className:"text-primary-800"}),description:"Establishing WebSocket connection"},{message:"Establishing secure connection",icon:(0,i.jsx)(v.C8d,{className:"text-primary-800"}),description:"Waiting for server acknowledgment"},{message:"Initializing video stream",icon:(0,i.jsx)(v.Wqt,{className:"text-primary-800"}),description:"Setting up video decoder"},{message:"Almost ready",icon:(0,i.jsx)(v.A7C,{className:"text-primary-800"}),description:"Waiting for first video frame"},{message:"Still working",icon:(0,i.jsx)(v.A7C,{className:"text-primary-800"}),description:"Taking a bit longer than usual, but we're getting there"}],m={connecting:{message:"Connecting to streaming server",description:"Establishing WebSocket connection"},connected:{message:"Establishing secure connection",description:"Waiting for server mode"},initializing:{message:"Initializing video stream",description:"Setting up video decoder and audio pipeline"},error:{message:"Connection issue",description:"Attempting to recover automatically"},disconnected:{message:"Reconnecting to server",description:"Connection lost - automatic retry in progress"}};(0,a.useEffect)(()=>{let e=setInterval(()=>{l(e=>{let t=e<h.length-1?e+1:e;return t!==e&&(0,_.A)("VIEWER","Loading phase changed to ".concat(t," - ").concat(h[t].message),"DEBUG","viewer-loading"),t})},4e3);return()=>clearInterval(e)},[]),(0,a.useEffect)(()=>{(0,_.A)("VIEWER","Status=".concat(t,", ViewerStatus=").concat(n),"DEBUG","viewer-loading")},[t,n]),(0,a.useEffect)(()=>{if(g.current)return;let e=setTimeout(()=>{window.__rrwebReportProblem&&!g.current&&(g.current=!0,window.__rrwebReportProblem("loadingstuck"),(0,_.A)("VIEWER","Loading stuck detected (>15s), reported to recording","WARN","viewer-loading"))},15e3);return()=>{clearTimeout(e)}},[]),(0,a.useEffect)(()=>{let e=(()=>{let e;if("notready"===t)e=20;else if(n)switch(n){case"connecting":e=40;break;case"connected":e=55;break;case"initializing":e=75;break;case"streaming":e=100;break;case"error":e=50;break;case"disconnected":e=45;break;default:e=30+(s+1)*(40/h.length)}else e=30+(s+1)*(40/h.length);return Math.min(e,100)})();d(t=>Math.max(t,e)),e>=95&&!u&&setTimeout(()=>p(!0),500)},[t,n,s]);let f=(()=>{if("notready"===t){let e=(null==o?void 0:o.status)||"Initializing";return{message:"Workspace Status: ".concat(e.charAt(0).toUpperCase()+e.slice(1)),description:"Setting up your secure browser environment"}}return n&&m[n]?m[n]:{message:h[s].message,description:h[s].description}})();return(0,i.jsx)("div",{className:"fixed inset-0 flex flex-col items-center justify-center bg-white z-50 pb-8",children:(0,i.jsxs)("div",{className:"w-full max-w-md md:max-w-2xl lg:max-w-3xl px-4",children:[(0,i.jsx)("div",{className:"flex justify-center mb-8",children:(0,i.jsx)("img",{src:r||"/img/logo.svg",alt:"Browser.lol logo",className:"max-h-12 w-auto"})}),(0,i.jsxs)("div",{className:"relative w-full",children:[(0,i.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[115%] h-[108%] rounded-3xl pointer-events-none",style:{background:"radial-gradient(circle at center, rgba(56, 189, 248, 0.15) 0%, rgba(99, 152, 255, 0.12) 35%, rgba(79, 134, 247, 0.08) 70%, transparent 100%)",filter:"blur(60px)",opacity:.6}}),(0,i.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[108%] h-[105%] rounded-3xl pointer-events-none",style:{background:"radial-gradient(circle at center, rgba(56, 189, 248, 0.45) 0%, rgba(99, 152, 255, 0.52) 25%, rgba(79, 134, 247, 0.28) 50%, rgba(59, 130, 246, 0.22) 75%, rgba(67, 120, 255, 0.15) 100%)",filter:"blur(40px)"}}),(0,i.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[130%] h-[130%] rounded-3xl pointer-events-none",style:{backgroundImage:"\n                repeating-linear-gradient(0deg, transparent, transparent 40px, rgba(99, 152, 255, 0.4) 40px, rgba(99, 152, 255, 0.4) 42px),\n                repeating-linear-gradient(90deg, transparent, transparent 40px, rgba(99, 152, 255, 0.4) 40px, rgba(99, 152, 255, 0.4) 42px)\n              ",WebkitMask:"radial-gradient(ellipse at center, black 0%, black 30%, rgba(0,0,0,0.5) 60%, transparent 90%)",mask:"radial-gradient(ellipse at center, black 0%, black 30%, rgba(0,0,0,0.5) 60%, transparent 90%)",opacity:.6}}),(0,i.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden transition-all duration-300 transform relative z-10",children:[(0,i.jsxs)("div",{className:"bg-gradient-to-r from-primary-800 to-primary-900 animate-gradient-slow p-6 relative overflow-hidden",children:[(0,i.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[(0,i.jsx)("div",{className:"absolute -right-12 -top-12 w-40 h-40 rounded-full bg-white opacity-20"}),(0,i.jsx)("div",{className:"absolute -left-12 -bottom-12 w-32 h-32 rounded-full bg-white opacity-10"})]}),(0,i.jsxs)("div",{className:"flex items-center relative z-10",children:[(0,i.jsx)("div",{className:"mr-4 bg-white/20 rounded-full p-3",children:(0,i.jsx)("div",{className:"w-10 h-10 flex items-center justify-center",children:(0,i.jsx)(B.AhV,{className:"text-white text-3xl animate-spin"})})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"font-medium text-xl text-white mb-1",children:"notready"===t?"Preparing Your Environment":"streaming"===n?"Stream Ready":"Connecting to Browser"}),(0,i.jsx)("p",{className:"text-primary-100 text-sm font-light",children:"streaming"===n?"Ready to launch your experience":"Setting up your secure cloud environment"})]})]})]}),(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,i.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:f.message}),(0,i.jsxs)("span",{className:"text-xs font-medium text-primary-800",children:[Math.round(c),"%"]})]}),(0,i.jsx)("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden mb-3",children:(0,i.jsx)("div",{className:"h-full bg-gradient-to-r from-primary-600 to-primary-800 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(c,"%")}})}),(0,i.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:f.description}),"notready"===t&&(0,i.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 flex items-start",children:[(0,i.jsx)(v.uoG,{className:"text-primary-800 mt-1 mr-3 flex-shrink-0"}),(0,i.jsx)("div",{children:(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Your browser is being prepared in a secure cloud environment. This typically takes just a few seconds."})})]})]})]})]})]})})}function V(){if("undefined"==typeof localStorage)return;let e=localStorage.getItem("vm"),t=e?"viewer_redirectUrl_".concat(e):null,n=t?localStorage.getItem(t):null;localStorage.removeItem("vm"),e&&(localStorage.removeItem("viewer_logo_".concat(e)),localStorage.removeItem("viewer_redirectUrl_".concat(e)));let i="/create";if(n)try{new URL(n),i=n}catch(e){(0,_.A)("UI","Invalid viewer redirectUrl found in localStorage (".concat(n,"), falling back to ").concat(i),"WARN","viewer-redirect-util")}(0,_.A)("UI","Viewer redirecting user to: ".concat(i),"INFO","viewer-redirect-util"),window.location.href=i}function q(e){let{message:t,details:n}=e;return(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",background:"#0a0a0a",fontFamily:"system-ui, -apple-system, sans-serif"},children:(0,i.jsxs)("div",{style:{textAlign:"center",color:"#fff",maxWidth:"500px",padding:"2rem"},children:[(0,i.jsx)("div",{style:{width:"64px",height:"64px",margin:"0 auto 1.5rem",borderRadius:"50%",background:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,i.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),(0,i.jsx)("h1",{style:{fontSize:"1.5rem",fontWeight:"600",margin:"0 0 0.5rem",color:"#dc2626"},children:t}),(0,i.jsx)("p",{style:{fontSize:"0.95rem",color:"#9ca3af",margin:"0",lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:n}})]})})}function H(e){let{message:t}=e;return(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",background:"#0a0a0a",fontFamily:"system-ui, -apple-system, sans-serif"},children:(0,i.jsxs)("div",{style:{textAlign:"center",color:"#fff"},className:"jsx-981d40e5d2284c5d",children:[(0,i.jsx)("div",{style:{width:"48px",height:"48px",margin:"0 auto 1rem",border:"3px solid #333",borderTopColor:"#61dafb",borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-981d40e5d2284c5d"}),(0,i.jsx)("p",{style:{color:"#9ca3af",margin:0},className:"jsx-981d40e5d2284c5d",children:t}),(0,i.jsx)(r(),{id:"981d40e5d2284c5d",children:"@keyframes spin{to{transform:rotate(360deg)}}"})]})})}let G=null;async function K(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;try{let n=new AbortController,i=setTimeout(()=>n.abort(),t),o=await fetch("https://".concat(e,"/robots"),{method:"HEAD",signal:n.signal});return clearTimeout(i),200===o.status}catch(e){return!1}}function J(){let e=(0,s.useSearchParams)(),t=(0,s.useRouter)(),n=(0,s.usePathname)(),[o,r]=(0,a.useState)("init"),[d,u]=(0,a.useState)({message:"",details:""}),[p,g]=(0,a.useState)(null),[h,m]=(0,a.useState)(!1),[f,v]=(0,a.useState)(null),[x,b]=(0,a.useState)(null),[y,w]=(0,a.useState)(null),[S,j]=(0,a.useState)(null),[k,R]=(0,a.useState)(!1),[I,N]=(0,a.useState)(null),[A,C]=(0,a.useState)(!1),W=(0,a.useRef)(!1),D=(0,a.useRef)(null),O=(0,a.useRef)(!1);return((0,a.useEffect)(()=>{document.title="\uD83D\uDD04 Workspace - Browser.lol"},[]),(0,a.useEffect)(()=>{document.title="streaming"===I?"▶️ Workspace - Browser.lol":"\uD83D\uDD04 Workspace - Browser.lol"},[I]),(0,a.useEffect)(()=>{let e=()=>{let e=document.getElementById("pw-oop-bottom_rail");C(!!e&&e.offsetHeight>0)};e();let t=setTimeout(e,1e3),n=new MutationObserver(()=>{e()});return n.observe(document.body,{childList:!0,subtree:!0}),()=>{clearTimeout(t),n.disconnect()}},[]),(0,a.useEffect)(()=>{let e=()=>{let e=document.getElementById("app");e&&(A?(e.style.height="calc(100vh - 90px)",e.style.maxHeight="calc(100vh - 90px)"):(e.style.height="100vh",e.style.maxHeight="100vh"))};e();let t=new MutationObserver(()=>{e()});return t.observe(document.body,{childList:!0,subtree:!0}),()=>{t.disconnect()}},[A]),(0,a.useEffect)(()=>{let i;if(W.current)return;W.current=!0;let o=!1,a=new URLSearchParams(e.toString());if(e.has("id")?(i=e.get("id"),localStorage.setItem("vm",i),a.delete("id"),o=!0):i=localStorage.getItem("vm"),!i){(0,_.A)("VIEWER","No workspace ID found in URL or localStorage","WARN","viewer-page"),c.oR.error("No active session found"),setTimeout(()=>{V()},2e3);return}let s=window.BROWSER_WORKSPACE_ID;s&&s!==i&&((0,_.A)("VIEWER","Workspace changed from ".concat(s," to ").concat(i,", clearing streaming flag"),"DEBUG","viewer-page"),window.__BROWSER_LOL_STREAMING__=!1),j(i);let d=e.get("logo"),u="viewer_logo_".concat(i);if(d){let e=d.startsWith("https://"),t=/\.(jpg|jpeg|png)$/i.test(d);e&&t?(localStorage.setItem(u,d),v(d)):(e?(0,_.A)("VIEWER","Invalid logo URL (must be .jpg, .jpeg, or .png): ".concat(d),"WARN","viewer-page"):(0,_.A)("VIEWER","Invalid logo URL (must use HTTPS): ".concat(d),"WARN","viewer-page"),localStorage.removeItem(u),v(null)),a.delete("logo"),o=!0}else{let e=localStorage.getItem(u);e&&(e.startsWith("https://")&&/\.(jpg|jpeg|png)$/i.test(e)?v(e):((0,_.A)("VIEWER","Invalid logo URL in localStorage: ".concat(e),"WARN","viewer-page"),localStorage.removeItem(u),v(null)))}let p=e.get("redirectUrl"),g="viewer_redirectUrl_".concat(i);if(p){try{new URL(p),localStorage.setItem(g,p),b(p)}catch(e){(0,_.A)("VIEWER","Invalid redirect URL: ".concat(p),"WARN","viewer-page"),localStorage.removeItem(g),b(null)}a.delete("redirectUrl"),o=!0}else{let e=localStorage.getItem(g);if(e)try{new URL(e),b(e)}catch(t){(0,_.A)("VIEWER","Invalid redirect URL in localStorage: ".concat(e),"WARN","viewer-page"),localStorage.removeItem(g),b(null)}}if(o){let e=a.toString()?"".concat(n,"?").concat(a.toString()):n;t.replace(e,{scroll:!1})}return(0,_.A)("VIEWER","Connecting to Socket.IO for workspace: ".concat(i),"INFO","viewer-page"),(G=(0,l.io)((0,E.w)(),{path:"/v7/workspace/socket.io",transports:["websocket"],auth:{token:i}})).io.on("reconnect_attempt",()=>{G.io.opts.auth={token:localStorage.getItem("vm")}}),G.on("connect",()=>{(0,_.A)("VIEWER","Connected to Socket.IO server","INFO","viewer-page"),D.current&&(clearTimeout(D.current),D.current=null,R(!1))}),G.on("disconnect",()=>{(0,_.A)("VIEWER","Disconnected from Socket.IO server","WARN","viewer-page"),R(!0),D.current=setTimeout(()=>{(0,_.A)("VIEWER","Still disconnected after 10 seconds","ERROR","viewer-page"),R(!0)},1e4)}),G.on("workspacedata",e=>{var t;(0,_.A)("VIEWER","Received workspace data for ".concat((null==e||null==(t=e.workspace)?void 0:t.id)||"unknown"),"DEBUG","viewer-page"),console.log("WORKSPACE DATA:",JSON.stringify(e,null,2)),w(e)}),G.on("error",e=>{(0,_.A)("VIEWER","Socket.IO error: ".concat(e.message||"Unknown error"),"ERROR","viewer-page")}),r("loading"),()=>{G&&(G.off("connect"),G.off("disconnect"),G.off("workspacedata"),G.off("error"),D.current&&(clearTimeout(D.current),D.current=null),G.disconnect(),G=null,(0,_.A)("VIEWER","Socket.IO connection cleaned up","DEBUG","viewer-page"));let e=document.getElementById("dashboard-root");e&&e.remove(),W.current=!1,O.current=!1}},[e,t,n]),(0,a.useEffect)(()=>{if(y){if((null==y?void 0:y.status)&&(null==y?void 0:y.status)!=="ok"){(0,_.A)("VIEWER","Server error occurred","ERROR","viewer-page"),c.oR.error("A Server error occurred"),setTimeout(()=>{V()},2e3);return}if(null==y?void 0:y.workspace)switch(y.workspace.status){case"running":(0,_.A)("VIEWER","Workspace is running, setting status to ready","INFO","viewer-page"),r("ready");break;case"starting":case"pending":(0,_.A)("VIEWER","Workspace status: ".concat(y.workspace.status),"INFO","viewer-page"),r("notready");break;case"deleted":(0,_.A)("VIEWER","Workspace has been deleted","WARN","viewer-page"),c.oR.error("This Workspace has been deleted"),setTimeout(()=>{V()},2e3);break;case"stopping":case"stopped":case"error":case"suspended":(0,_.A)("VIEWER","Workspace is ".concat(y.workspace.status),"WARN","viewer-page"),c.oR.error("This workspace is currently unavailable"),setTimeout(()=>{V()},2e3);break;default:r("notready")}}},[y]),(0,a.useEffect)(()=>{if("ready"===o&&S&&!O.current){if(O.current=!0,window.__BROWSER_LOL_STREAMING__){(0,_.A)("VIEWER","Viewer already streaming, setting status","INFO","viewer-page"),N("streaming");return}(async()=>{var e,t,n;(0,_.A)("VIEWER","Loading viewer-core for workspace: ".concat(S),"INFO","viewer-page"),window.BROWSER_WORKSPACE_ID=S,window.BROWSER_IS_PREMIUM=(null==y||null==(e=y.workspace)?void 0:e.premium)===!0;let i="https:"===window.location.protocol?"wss:":"ws:",o=null==y||null==(t=y.workspace)?void 0:t.url,a=(0,E.r)(),s=null==y||null==(n=y.workspace)?void 0:n.continent,l=s?"/".concat(s,"/selkies"):"/selkies",c="".concat(i,"//").concat(a).concat(l,"/").concat(S,"/websockets");if(o){let e="".concat(i,"//").concat(o).concat(l,"/").concat(S,"/websockets");(0,_.A)("VIEWER","Testing cluster reachability: ".concat(o),"DEBUG","viewer-page"),await K(o)?(window.BROWSER_WEBSOCKET_URL=e,(0,_.A)("VIEWER","Using cluster URL: ".concat(window.BROWSER_WEBSOCKET_URL),"INFO","viewer-page")):(window.BROWSER_WEBSOCKET_URL=c,(0,_.A)("VIEWER","Cluster unreachable, using fallback: ".concat(window.BROWSER_WEBSOCKET_URL),"WARN","viewer-page"))}else window.BROWSER_WEBSOCKET_URL=c,(0,_.A)("VIEWER","No cluster URL, using backend: ".concat(window.BROWSER_WEBSOCKET_URL),"DEBUG","viewer-page");if(!document.getElementById("app")){let e=document.createElement("div");e.id="app",document.body.appendChild(e)}(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((n,i)=>{if(document.querySelector('script[src="'.concat(e,'"]'))){(0,_.A)("VIEWER","Script already loaded: ".concat(e),"DEBUG","viewer-page"),n();return}let o=document.createElement("script");o.src=e,t&&(o.type="module"),o.onload=n,o.onerror=i,document.head.appendChild(o)})})("/viewer/viewer-core.js",!0).then(()=>{if((0,_.A)("VIEWER","viewer-core loaded successfully","INFO","viewer-page"),!["#shared","#player2","#player3","#player4"].includes(window.location.hash)){let e=document.getElementById("dashboard-root");e||((e=document.createElement("div")).id="dashboard-root",document.body.appendChild(e)),g(e),m(!0)}}).catch(e=>{(0,_.A)("VIEWER","Failed to load viewer-core: ".concat(e),"ERROR","viewer-page"),u({message:"Failed to Load Viewer",details:"Could not initialize the streaming components. Please refresh the page or try again later."}),r("error")})})()}},[o,S]),(0,a.useEffect)(()=>{let e=e=>{var t,n,i,o;if((null==(t=e.data)?void 0:t.type)==="viewer-status"){let t=e.data.status;(0,_.A)("VIEWER","Received viewer status: ".concat(t),"DEBUG","viewer-page"),N(t)}(null==(n=e.data)?void 0:n.type)==="audioDecoderUnavailable"&&((0,_.A)("VIEWER","Audio decoder unavailable: ".concat(e.data.reason),"WARN","viewer-page"),(0,c.oR)("Audio is not supported, please upgrade your browser.",{icon:"\uD83D\uDD07",duration:6e3,style:{background:"#333",color:"#fff"}})),(null==(i=e.data)?void 0:i.type)==="browserUnsupported"&&((0,_.A)("VIEWER","Browser unsupported: ".concat(e.data.reason),"ERROR","viewer-page"),u({message:"Browser Not Supported",details:"".concat(e.data.reason,"<br/><br/>").concat(e.data.suggestion)}),r("error")),(null==(o=e.data)?void 0:o.type)==="decodingError"&&((0,_.A)("VIEWER","Decoding error: ".concat(e.data.reason),"WARN","viewer-page"),c.oR.error("".concat(e.data.reason," ").concat(e.data.suggestion||""),{duration:1e4,style:{background:"#333",color:"#fff"}}))};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[]),"init"===o||"loading"===o||"notready"===o||"ready"===o&&"streaming"!==I)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.l$,{position:"top-center"}),(0,i.jsx)(P,{status:o,viewerStatus:I,workspace:null==y?void 0:y.workspace,logoUrl:f})]}):"error"===o?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.l$,{position:"top-center"}),(0,i.jsx)(q,{message:d.message,details:d.details})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.l$,{position:"top-center"}),h&&p&&(0,i.jsx)(L,{container:p})]})}function Y(){return(0,i.jsx)(a.Suspense,{fallback:(0,i.jsx)(H,{message:"Loading..."}),children:(0,i.jsx)(J,{})})}},36032:(e,t,n)=>{"use strict";n.d(t,{E:()=>d,default:()=>u});var i=n(95155),o=n(12115),r=n(43522),a=n(99776),s=n(38217),l=n(22663);let c=new r.E,d=(0,o.createContext)();function u(e){let{children:t}=e,[n,r]=(0,o.useState)({});return(0,i.jsx)(d.Provider,{value:{user:n,setUser:r},children:(0,i.jsxs)(a.Ht,{client:c,children:[t,(0,i.jsx)(l.l$,{position:"top-center"}),(0,i.jsx)(s.E,{initialIsOpen:!1})]})})}},45688:(e,t,n)=>{"use strict";var i=n(95704);n(86340);var o=n(12115),r=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(o),a=void 0!==i&&i.env&&!0,s=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,n=t.name,i=void 0===n?"stylesheet":n,o=t.optimizeForSpeed,r=void 0===o?a:o;c(s(i),"`name` must be a string"),this._name=i,this._deletedRulePlaceholder="#"+i+"-deleted-rule____{}",c("boolean"==typeof r,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=r,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,n=e.prototype;return n.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},n.isOptimizeForSpeed=function(){return this._optimizeForSpeed},n.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(a||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,n){return"number"==typeof n?e._serverSheet.cssRules[n]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),n},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},n.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},n.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},n.insertRule=function(e,t){if(c(s(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var n=this.getSheet();"number"!=typeof t&&(t=n.cssRules.length);try{n.insertRule(e,t)}catch(t){return a||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var i=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,i))}return this._rulesCount++},n.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var n="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!n.cssRules[e])return e;n.deleteRule(e);try{n.insertRule(t,e)}catch(i){a||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),n.insertRule(this._deletedRulePlaceholder,e)}}else{var i=this._tags[e];c(i,"old rule at index `"+e+"` not found"),i.textContent=t}return e},n.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},n.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},n.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,n){return n?t=t.concat(Array.prototype.map.call(e.getSheetForTag(n).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},n.makeStyleTag=function(e,t,n){t&&c(s(t),"makeStyleTag accepts only strings as second parameter");var i=document.createElement("style");this._nonce&&i.setAttribute("nonce",this._nonce),i.type="text/css",i.setAttribute("data-"+e,""),t&&i.appendChild(document.createTextNode(t));var o=document.head||document.getElementsByTagName("head")[0];return n?o.insertBefore(i,n):o.appendChild(i),i},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return t>>>0},u={};function p(e,t){if(!t)return"jsx-"+e;var n=String(t),i=e+n;return u[i]||(u[i]="jsx-"+d(e+"-"+n)),u[i]}function g(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var n=e+t;return u[n]||(u[n]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[n]}var h=function(){function e(e){var t=void 0===e?{}:e,n=t.styleSheet,i=void 0===n?null:n,o=t.optimizeForSpeed,r=void 0!==o&&o;this._sheet=i||new l({name:"styled-jsx",optimizeForSpeed:r}),this._sheet.inject(),i&&"boolean"==typeof r&&(this._sheet.setOptimizeForSpeed(r),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var n=this.getIdAndRules(e),i=n.styleId,o=n.rules;if(i in this._instancesCounts){this._instancesCounts[i]+=1;return}var r=o.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[i]=r,this._instancesCounts[i]=1},t.remove=function(e){var t=this,n=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(n in this._instancesCounts,"styleId: `"+n+"` not found"),this._instancesCounts[n]-=1,this._instancesCounts[n]<1){var i=this._fromServer&&this._fromServer[n];i?(i.parentNode.removeChild(i),delete this._fromServer[n]):(this._indices[n].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[n]),delete this._instancesCounts[n]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],n=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return n[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,n;return t=this.cssRules(),void 0===(n=e)&&(n={}),t.map(function(e){var t=e[0],i=e[1];return r.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:n.nonce?n.nonce:void 0,dangerouslySetInnerHTML:{__html:i}})})},t.getIdAndRules=function(e){var t=e.children,n=e.dynamic,i=e.id;if(n){var o=p(i,n);return{styleId:o,rules:Array.isArray(t)?t.map(function(e){return g(o,e)}):[g(o,t)]}}return{styleId:p(i),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),m=o.createContext(null);m.displayName="StyleSheetContext";var f=r.default.useInsertionEffect||r.default.useLayoutEffect,v="undefined"!=typeof window?new h:void 0;function x(e){var t=v||o.useContext(m);return t&&("undefined"==typeof window?t.add(e):f(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}x.dynamic=function(e){return e.map(function(e){return p(e[0],e[1])}).join(" ")},t.style=x},47992:(e,t,n)=>{"use strict";function i(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];{let t=localStorage.getItem("BACKEND_URL");if(t)return t.startsWith("https://")||t.startsWith("http://")?e?t:t.replace(/^https?:\/\//,""):e?"https://".concat(t):t}return e?"https://".concat("api.browser.lol"):"api.browser.lol"}function o(){return i(!1)}n.d(t,{r:()=>o,w:()=>i})},50497:()=>{},76648:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(10351),o=n(47992);async function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{(0,i.A)("api-request","Requesting ".concat(t," to ").concat(e," with options: ").concat(JSON.stringify(n)),"DEBUG","frontend/api");let s=localStorage.getItem("auth"),l=await a(e,t,s,n);if((null==l?void 0:l.status)&&!0===l.forceLogout&&!o){(0,i.A)("api-force-logout","Unauthorized detected. Attempting session refresh...","WARN","frontend/api");let o=await r("/session/create","POST",{},!0);if((null==o?void 0:o.status)==="ok"&&(null==o?void 0:o.key)){(0,i.A)("api-session-refresh","Successfully created a new session after force logout.","INFO","frontend/api"),localStorage.setItem("auth",o.key);let r=localStorage.getItem("auth");return await a(e,t,r,n)}(0,i.A)("api-session-refresh-failed","Failed to create a new session after force logout.","ERROR","frontend/api"),localStorage.removeItem("auth")}return l}catch(o){return(0,i.A)("api-error","Error in fetchApi: ".concat(o.message),"ERROR","frontend/api"),(0,i.A)("api-request-details","Request details: URL=".concat(e,", Method=").concat(t,", Options=").concat(JSON.stringify(n)),"ERROR","frontend/api"),(0,i.A)("api-error-stack","Error stack: ".concat(o.stack||"No stack trace available"),"ERROR","frontend/api"),{status:"error",message:o.message||"An unknown error occurred"}}}async function a(e,t,n,r){let a=null,s="",l=performance.now();try{s="".concat((0,o.w)(),"/v7").concat(e),a="GET"===t?await fetch(s,{method:t,headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}}):await fetch(s,{method:t,headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify(r)});let c=await a.json();if(null==c?void 0:c.status){let t=((performance.now()-l)/1e3).toFixed(3);return(0,i.A)("api-success","Request succeeded to ".concat(e," in ").concat(t,"s: ").concat(JSON.stringify(c)),"DEBUG","frontend/api"),(null==c?void 0:c.authToken)&&localStorage.setItem("auth",c.authToken),c}return(0,i.A)("api-failed","Request failed to ".concat(e,": ").concat(JSON.stringify(c)),"WARN","frontend/api"),{status:"error",message:"Invalid server response"}}catch(o){(0,i.A)("api-error","Error in fetchUrl: ".concat(o.message),"ERROR","frontend/api"),(0,i.A)("api-request-details","Request details: URL=".concat(e,", Full URL=").concat("string"==typeof s?s:"Invalid URL",", Method=").concat(t),"ERROR","frontend/api"),(0,i.A)("api-options","Options: ".concat(JSON.stringify(r)),"ERROR","frontend/api"),a&&(0,i.A)("api-response-status","Response status: ".concat(a.status||"N/A"),"ERROR","frontend/api"),(0,i.A)("api-error-stack","Error stack: ".concat(o.stack||"No stack trace available"),"ERROR","frontend/api");let n="Failed to connect to server";return"TypeError"===o.name&&o.message.includes("fetch")?n="Network error: Unable to reach the server. Check your internet connection":"SyntaxError"===o.name?n="Server returned invalid response. Please try again":a?n=a.status>=500?"Server error (".concat(a.status,"). Please try again later"):a.status>=400?"Request failed (".concat(a.status,"). Please check your request"):"Request failed with status ".concat(a.status):o.message&&(n="Connection error: ".concat(o.message)),{status:"error",message:n}}}},80921:(e,t,n)=>{"use strict";n.d(t,{R9:()=>m,bz:()=>g});var i=n(95155),o=n(12115),r=n(22663),a=n(64531),s=n(71408),l=n(70898),c=n(42878),d=n(6092),u=n(10351);let p=null,g=e=>{p=e},h=e=>{let{email:t,toastId:n}=e,[s,u]=(0,o.useState)(!1),g=t.ai_summary||t.subject||"New Email Received",h=t.ai_calltoaction&&t.ai_calltoaction_value?t.ai_calltoaction_value:null,m=(0,o.useCallback)(()=>{h&&(navigator.clipboard.writeText(h),u(!0),setTimeout(()=>u(!1),2e3))},[h]),f=(0,o.useCallback)(()=>{r.Ay.dismiss(n),p&&p(t.id)},[t,n]),v=(0,o.useCallback)(()=>{r.Ay.dismiss(n)},[n]);return(0,i.jsxs)(a.P.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{type:"spring",duration:.4,bounce:.25},className:"w-80 bg-white/95 backdrop-blur-xl rounded-xl shadow-lg shadow-slate-200/50 border border-slate-200/80 overflow-hidden",children:[(0,i.jsx)("div",{className:"h-1 bg-gradient-to-r from-sky-500 to-blue-600"}),(0,i.jsxs)("div",{className:"flex items-start gap-3 p-4 pb-2",children:[(0,i.jsx)("div",{className:"flex-shrink-0 w-9 h-9 rounded-lg bg-gradient-to-br from-sky-100 to-blue-100 flex items-center justify-center",children:(0,i.jsx)(c.SOx,{className:"w-4.5 h-4.5 text-sky-600"})}),(0,i.jsxs)("div",{className:"flex-1 min-w-0 pr-6",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-slate-500 mb-0.5",children:"New Email"}),(0,i.jsx)("h4",{className:"text-sm font-semibold text-slate-800 leading-snug line-clamp-2",children:g})]}),(0,i.jsx)("button",{onClick:v,className:"absolute top-3 right-3 p-1.5 rounded-lg text-slate-400 hover:text-slate-600 hover:bg-slate-100 transition-colors",children:(0,i.jsx)(l.QCr,{className:"w-3 h-3"})})]}),h&&(0,i.jsx)("div",{className:"px-4 pb-3",children:(0,i.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-slate-50 rounded-lg border border-slate-200",children:[(0,i.jsx)(d.vky,{className:"w-3.5 h-3.5 text-sky-500 flex-shrink-0"}),(0,i.jsx)("code",{className:"flex-1 text-xs font-mono text-slate-700 truncate",children:h}),(0,i.jsx)("button",{onClick:m,className:"flex-shrink-0 p-1.5 rounded-md transition-all duration-200 ".concat(s?"bg-green-500 text-white":"bg-white text-slate-500 hover:text-sky-600 hover:bg-sky-50 border border-slate-200"),title:s?"Copied!":"Copy",children:s?(0,i.jsx)(l.CMH,{className:"w-3 h-3"}):(0,i.jsx)(l.paH,{className:"w-3 h-3"})})]})}),(0,i.jsx)("div",{className:"px-4 pb-4",children:(0,i.jsx)("button",{onClick:f,className:"w-full py-2 px-4 text-sm font-medium text-sky-600 bg-sky-50 hover:bg-sky-100 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:"View Email"})})]})},m=e=>{if(!e)return void(0,u.A)("MAIL","Cannot show toast: email data is missing","ERROR","mail-toast");let t="email-".concat(e.id||Date.now());r.Ay.custom(t=>(0,i.jsx)(s.N,{mode:"wait",children:t.visible&&(0,i.jsx)(h,{email:e,toastId:t.id})}),{id:t,position:"bottom-right",duration:15e3})}},86340:()=>{},88661:(e,t,n)=>{"use strict";e.exports=n(45688).style}},e=>{e.O(0,[6614,5479,6711,8087,3603,512,5271,754,6743,2663,4531,6266,2454,4359,8441,1255,7358],()=>e(e.s=9952)),_N_E=e.O()}]);