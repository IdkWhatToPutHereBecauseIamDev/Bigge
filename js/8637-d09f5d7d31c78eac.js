"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8637],{45504:(e,t,a)=>{a.d(t,{j:()=>n,r:()=>l});var s=a(10351);function l(e){if(e&&"/auth"!==e)try{if(e.startsWith("/auth")||"/"===e)return;localStorage.setItem("loginRedirect",e)}catch(e){(0,s.A)("AUTH","Error saving login redirect: ".concat(e.message),"ERROR","login-redirect")}}function n(e,t){l(t),e("/auth")}},68637:(e,t,a)=>{let s;a.d(t,{default:()=>j,j:()=>w,s:()=>s});var l=a(95155),n=a(12115),o=a(99776),r=a(22454),i=a(36032),c=a(20063),d=a(9829),u=a(80921),m=a(10351),x=a(47992),h=a(45504),g=a(47650),f=a(64531),b=a(70898),p=a(76648),v=a(22663),y=a(60305);function k(e){let{user:t,socket:a,queryClient:s,onReactivate:r}=e,i=(0,o.jE)(),c=s||i,[d,u]=(0,n.useState)(!1),[m,x]=(0,n.useState)(!1);(0,n.useEffect)(()=>(x(!0),()=>x(!1)),[]);let h=(null==t?void 0:t.disabled)!==null&&(null==t?void 0:t.disabled)!==void 0,k=h&&(null==t?void 0:t.disabled)?new Date(t.disabled):null,w=async()=>{u(!0);try{let e=await (0,p.A)("/user/disable","POST",{disabled:!1});"ok"===e.status?(v.Ay.success("Your account has been reactivated! Deletion has been canceled.",{duration:4e3}),c.invalidateQueries(["getUserData"]),r&&r()):v.Ay.error(e.message||"Error reactivating account.")}catch(e){v.Ay.error("Network error. Please try again.")}finally{u(!1)}},j=async()=>{await (0,y.A)({all:!1,queryClient:c,socket:a,showToast:!0,redirect:!0})};if(!m||!h)return null;let N=(0,l.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/70 backdrop-blur-md z-[9999] flex items-center justify-center p-4",children:(0,l.jsxs)(f.P.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},transition:{type:"spring",duration:.5},className:"bg-white p-8 rounded-2xl max-w-lg w-full border border-red-200 shadow-2xl",children:[(0,l.jsxs)("div",{className:"text-center mb-8",children:[(0,l.jsx)("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,l.jsx)(b.w_X,{className:"w-10 h-10 text-red-600"})}),(0,l.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Account Scheduled for Deletion"}),(0,l.jsxs)("p",{className:"text-gray-700 text-lg mb-2",children:["Your account was scheduled for deletion on ",null==k?void 0:k.toLocaleDateString("en-US"),"."]}),(0,l.jsxs)("p",{className:"text-red-600 font-semibold text-xl mb-6",children:[(0,l.jsxs)("strong",{children:[(()=>{if(!k)return 0;let e=new Date(k.getTime()+6048e5),t=new Date;return Math.max(0,Math.ceil((e.getTime()-t.getTime())/864e5))})()," days"]})," remaining until permanent deletion."]})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:"You can cancel the deletion or logout from your account."}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,l.jsx)(f.P.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:w,disabled:d,className:"flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-sky-500 text-white rounded-lg font-medium text-sm hover:opacity-90 transition-all duration-300 disabled:opacity-50 min-w-[160px]",children:d?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),(0,l.jsx)("span",{children:"Reactivating..."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.EEI,{className:"w-4 h-4"}),(0,l.jsx)("span",{children:"Cancel Deletion"})]})}),(0,l.jsxs)(f.P.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:j,className:"flex items-center justify-center gap-2 px-6 py-3 bg-slate-100 border border-slate-300 text-slate-700 rounded-lg font-medium text-sm hover:bg-slate-200 transition-colors duration-300 min-w-[120px]",children:[(0,l.jsx)(b.axc,{className:"w-4 h-4"}),(0,l.jsx)("span",{children:"Logout"})]})]})]})]})});return(0,g.createPortal)(N,document.body)}async function w(){return s.emit("userdata",{token:localStorage.getItem("auth")},e=>{"ok"!==e.status&&((0,m.A)("socket-userdata-error","Error requesting Userdata: ".concat(JSON.stringify(e)),"WARN","frontend/auth"),s.off("userdata"))}),"ok"}function j(){let e=(0,c.usePathname)(),t=(0,c.useRouter)(),a=(0,o.jE)(),{user:g,setUser:f}=(0,n.useContext)(i.E);return(0,r.I)({queryFn:()=>w(),queryKey:["getUserData"],staleTime:5,refetchInterval:6e4,refetchOnWindowFocus:!0,refetchOnReconnect:!0,refetchOnMount:!1}),(0,n.useEffect)(()=>{var a,s,l;if((null==g?void 0:g.loggedIn)===!1)localStorage.removeItem("ident"),localStorage.removeItem("accessToken"),e.includes("/dash")&&(0,h.j)(t.push,e);else if((null==g?void 0:g.loggedIn)===!0&&(e.includes("/auth")||e.startsWith("/sso"))){let e=localStorage.getItem("loginRedirect");localStorage.removeItem("loginRedirect"),(null==e?void 0:e.length)>0?((0,m.A)("AUTH","Redirecting to: ".concat(e),"INFO","login-status"),window.location.href=e):window.location.href="/dash"}if((null==g||null==(a=g.user)?void 0:a.unlock_premium)===!0?localStorage.setItem("ident","vmSrv"):((null==g?void 0:g.loggedIn)===!1||(null==g||null==(s=g.user)?void 0:s.unlock_premium)===!1)&&localStorage.removeItem("ident"),null==g||null==(l=g.user)?void 0:l.email){let e=btoa(g.user.email);localStorage.setItem("accessToken",e)}},[g,e]),(0,n.useEffect)(()=>(a.setQueryData(["getUserData"],()=>"initial"),s||((s=(0,d.Ay)((0,x.w)(),{path:"/v7/user/socket.io",transports:["websocket"],auth:{token:localStorage.getItem("auth")}})).io.on("reconnect_attempt",()=>{s.io.opts.auth={token:localStorage.getItem("auth")}}),s.on("connect",()=>{(0,m.A)("socket-connect","Connected to Socket.IO-Server","INFO","frontend/socket")}),s.on("disconnect",()=>{(0,m.A)("socket-disconnect","Disconnected from Socket.IO-Server","INFO","frontend/socket")}),s.on("userdata",e=>{(0,m.A)("socket-userdata","Received Userdata: ".concat(JSON.stringify(e)),"DEBUG","frontend/socket"),f(e)}),s.on("tempmail_received",e=>{if((0,m.A)("socket-tempmail","Received TempMail data: ".concat(JSON.stringify(e)),"DEBUG","frontend/mail"),(null==e?void 0:e.status)==="ok"&&(null==e?void 0:e.email)){let{email:t}=e;a.invalidateQueries(["tempmailMessages"]),(0,u.R9)(t)}}),s.on("error",e=>{(0,m.A)("socket-error","Socket.IO-Error: ".concat(JSON.stringify(e)),"ERROR","frontend/socket")})),()=>{s&&(s.off("connect"),s.off("disconnect"),s.off("userdata"),s.off("tempmail_received"),s.off("error"),s.disconnect(),s=null,(0,m.A)("socket-cleanup","Socket.IO connection cleaned up","INFO","frontend/socket"))}),[]),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(k,{user:null==g?void 0:g.user,socket:s,queryClient:a})})}},80921:(e,t,a)=>{a.d(t,{R9:()=>g,bz:()=>x});var s=a(95155),l=a(12115),n=a(22663),o=a(64531),r=a(71408),i=a(70898),c=a(42878),d=a(6092),u=a(10351);let m=null,x=e=>{m=e},h=e=>{let{email:t,toastId:a}=e,[r,u]=(0,l.useState)(!1),x=t.ai_summary||t.subject||"New Email Received",h=t.ai_calltoaction&&t.ai_calltoaction_value?t.ai_calltoaction_value:null,g=(0,l.useCallback)(()=>{h&&(navigator.clipboard.writeText(h),u(!0),setTimeout(()=>u(!1),2e3))},[h]),f=(0,l.useCallback)(()=>{n.Ay.dismiss(a),m&&m(t.id)},[t,a]),b=(0,l.useCallback)(()=>{n.Ay.dismiss(a)},[a]);return(0,s.jsxs)(o.P.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},transition:{type:"spring",duration:.4,bounce:.25},className:"w-80 bg-white/95 backdrop-blur-xl rounded-xl shadow-lg shadow-slate-200/50 border border-slate-200/80 overflow-hidden",children:[(0,s.jsx)("div",{className:"h-1 bg-gradient-to-r from-sky-500 to-blue-600"}),(0,s.jsxs)("div",{className:"flex items-start gap-3 p-4 pb-2",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-9 h-9 rounded-lg bg-gradient-to-br from-sky-100 to-blue-100 flex items-center justify-center",children:(0,s.jsx)(c.SOx,{className:"w-4.5 h-4.5 text-sky-600"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 pr-6",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-slate-500 mb-0.5",children:"New Email"}),(0,s.jsx)("h4",{className:"text-sm font-semibold text-slate-800 leading-snug line-clamp-2",children:x})]}),(0,s.jsx)("button",{onClick:b,className:"absolute top-3 right-3 p-1.5 rounded-lg text-slate-400 hover:text-slate-600 hover:bg-slate-100 transition-colors",children:(0,s.jsx)(i.QCr,{className:"w-3 h-3"})})]}),h&&(0,s.jsx)("div",{className:"px-4 pb-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-slate-50 rounded-lg border border-slate-200",children:[(0,s.jsx)(d.vky,{className:"w-3.5 h-3.5 text-sky-500 flex-shrink-0"}),(0,s.jsx)("code",{className:"flex-1 text-xs font-mono text-slate-700 truncate",children:h}),(0,s.jsx)("button",{onClick:g,className:"flex-shrink-0 p-1.5 rounded-md transition-all duration-200 ".concat(r?"bg-green-500 text-white":"bg-white text-slate-500 hover:text-sky-600 hover:bg-sky-50 border border-slate-200"),title:r?"Copied!":"Copy",children:r?(0,s.jsx)(i.CMH,{className:"w-3 h-3"}):(0,s.jsx)(i.paH,{className:"w-3 h-3"})})]})}),(0,s.jsx)("div",{className:"px-4 pb-4",children:(0,s.jsx)("button",{onClick:f,className:"w-full py-2 px-4 text-sm font-medium text-sky-600 bg-sky-50 hover:bg-sky-100 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:"View Email"})})]})},g=e=>{if(!e)return void(0,u.A)("MAIL","Cannot show toast: email data is missing","ERROR","mail-toast");let t="email-".concat(e.id||Date.now());n.Ay.custom(t=>(0,s.jsx)(r.N,{mode:"wait",children:t.visible&&(0,s.jsx)(h,{email:e,toastId:t.id})}),{id:t,position:"bottom-right",duration:15e3})}}}]);